language: C
dist: xenial

stages:
  - Base
  - Lint
  - Test

jobs:
  include:
    - name: verifying travis.yml file
      stage: Base
      script:
        - python3 .travis_gen.py > expected.out
        - diff .travis.yml expected.out
    - name: test project compile
      stage: Base
      install:
        - travis_retry curl -L https://www.libsdl.org/release/SDL2-2.0.9.tar.gz | tar xz; cd SDL2-2.0.9; ./configure; make; sudo make install; cd ..; rm -rf SDL2-2.0.9
      script:
        - make
    - name: all C files in Makefile
      stage: Base
      script:
        - diff <(make print-SRC | tr ' ' '\n' | sort) <(find src -name "*.c" | sort)
    - name: all headers files in Makefile
      stage: Base
      script:
        - diff <(make print-INC | tr ' ' '\n' | sort) <(find inc -name "*.h" | sort)
